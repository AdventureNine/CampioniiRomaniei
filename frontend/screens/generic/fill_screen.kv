#:import AppColors frontend.utils.colors.AppColors

<GenericFillScreen>:
    Image:
        source: root.bg_image
        fit_mode: "cover"
        size_hint: 1, 1
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

    Widget:
        size_hint: 1, 1
        canvas:
            Color:
                rgba: 0, 0, 0, 0.4
            Rectangle:
                pos: self.pos
                size: self.size

    FloatLayout:
        StandardHeader:
            title: "Completează spațiul"
            header_color: root.primary_color
            pos_hint: {'top': 1}
            back_screen: 'region_dashboard'

        RelativeLayout:
            size_hint: 0.4, 0.4
            pos_hint: {'center_x': 0.5, 'top': 0.85}

            Image:
                source: root.question_bg_image
                fit_mode: "fill"
                size_hint: 1, 1
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                opacity: 1 if root.question_bg_image else 0

            Widget:
                size_hint: 1, 1
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                opacity: 0 if root.question_bg_image else 1
                canvas:
                    Color:
                        rgba: 1, 1, 1, 0.9
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20,]

            Label:
                text: root.question_text
                font_size: '22sp'
                bold: True
                color: AppColors.TEXT_PRIMARY
                halign: 'center'
                valign: 'middle'

                text_size: self.width * 0.8, self.height * 0.8
                size_hint: 1, 1
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        BoxLayout:
            orientation: 'horizontal'

            size_hint: 0.8, 0.12
            pos_hint: {'center_x': 0.5, 'y': 0.15} # Poziționat jos

            spacing: "20dp"

            TextInput:
                id: input_box
                hint_text: "Scrie răspunsul..."
                multiline: False
                font_size: '24sp'

                size_hint_x: 0.7

                padding: [15, (self.height - self.line_height) / 2]

                halign: 'center'
                background_normal: ''
                background_active: ''
                background_color: (1, 1, 1, 1)
                foreground_color: AppColors.TEXT_PRIMARY
                cursor_color: root.primary_color

                canvas.after:
                    Color:
                        rgba: root.primary_color
                    Line:
                        rounded_rectangle: (self.x, self.y, self.width, self.height, 15)
                        width: 2

            Button:
                text: "Verifică"

                # Ocupă restul de 30% din lățime
                size_hint_x: 0.3

                background_normal: ''
                background_color: (0,0,0,0) # Transparent ca să desenăm noi
                font_size: '20sp'
                bold: True
                color: AppColors.WHITE

                canvas.before:
                    Color:
                        rgba: root.primary_color
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [15,]
                    # Efect de bordură
                    Color:
                        rgba: 1, 1, 1, 0.3
                    Line:
                        rounded_rectangle: (self.x, self.y, self.width, self.height, 15)
                        width: 2

                on_release: root.check_answer()