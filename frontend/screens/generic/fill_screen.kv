#:import AppColors frontend.utils.colors.AppColors

<GenericFillScreen>:
    Image:
        source: root.bg_image
        fit_mode: "cover"
        size_hint: 1, 1
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

    Widget:
        size_hint: 1, 1
        canvas:
            Color:
                rgba: 0, 0, 0, 0.4
            Rectangle:
                pos: self.pos
                size: self.size

    FloatLayout:
        StandardHeader:
            title: "Completează spațiul"
            header_color: root.primary_color
            pos_hint: {'top': 1}
            back_screen: 'region_dashboard'

        # --- CASETA CU ÎNTREBAREA ---
        RelativeLayout:
            size_hint: None, None
            size: 700, 400
            pos_hint: {'center_x': 0.5, 'center_y': 0.68}

            Image:
                source: root.question_bg_image
                fit_mode: "contain"
                size_hint: 1, 1
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                opacity: 1 if root.question_bg_image else 0

            Widget:
                size_hint: 0.9, 0.7
                pos_hint: {'center_x': 0.5, 'center_y': 0.45}
                opacity: 0 if root.question_bg_image else 1
                canvas:
                    Color:
                        rgba: 1, 1, 1, 0.9
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20,]

            Label:
                text: root.question_text
                font_size: '20sp'
                bold: True
                color: AppColors.TEXT_PRIMARY

                halign: 'center'
                valign: 'middle'
                text_size: self.width * 0.6, self.height * 0.6

                size_hint: 1, 1
                pos_hint: {'center_x': 0.5, 'center_y': 0.45}

        # --- ZONA DE RĂSPUNS ---
        BoxLayout:
            orientation: 'horizontal'
            size_hint: None, None
            size: 500, 70
            pos_hint: {'center_x': 0.5, 'y': 0.15}
            spacing: 20

            # --- INPUT BOX ---
            TextInput:
                id: input_box
                hint_text: "Scrie răspunsul..."
                multiline: False
                font_size: '24sp'

                padding: [15, (self.height - self.line_height) / 2]

                halign: 'center'
                background_normal: ''
                background_active: ''
                background_color: (1, 1, 1, 1)
                foreground_color: AppColors.TEXT_PRIMARY
                cursor_color: root.primary_color

                canvas.after:
                    Color:
                        rgba: root.primary_color
                    Line:
                        rounded_rectangle: (self.x, self.y, self.width, self.height, 10)
                        width: 2

            # --- BUTONUL DE VERIFICARE ---
            Button:
                text: "Verifică"
                size_hint_x: None
                width: 200
                background_normal: ''
                background_color: root.primary_color
                font_size: '20sp'
                bold: True
                color: AppColors.WHITE

                canvas.before:
                    Color:
                        rgba: self.background_color
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [10,]

                on_release: root.check_answer()